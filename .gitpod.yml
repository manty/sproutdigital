# Gitpod / Ona Configuration
# For 200 workshop attendees - Zero Install Setup
#
# IMPORTANT: 'init' runs during PREBUILD (cached)
#            'command' runs at STARTUP (every time)

github:
  prebuilds:
    main: true
    branches: true
    pullRequests: true
    pullRequestsFromForks: false
    addCheck: true
    addComment: false
    addBadge: true

# Use Gitpod's full workspace image (Node 20 + Python + Go + etc)
image: gitpod/workspace-full:latest

tasks:
  # Task 1: Welcome server - serves the HTML welcome page
  - name: Welcome Page
    init: |
      echo "Installing dependencies..."
      npm install
      echo "Installing Playwright..."
      npx playwright install chromium
      echo "Installing Claude Code..."
      npm install -g @anthropic-ai/claude-code
      echo "Prebuild complete!"
    command: |
      echo "Starting welcome server..."
      npx http-server -p 3000 -c-1 --silent &
      sleep 2
      gp preview $(gp url 3000)/welcome.html
      echo ""
      echo "=============================================="
      echo "  WELCOME TO GEEKOUT VEGAS 2026!"
      echo "  Check the BROWSER PREVIEW for instructions"
      echo "=============================================="
      echo ""
      echo "Quick Start:"
      echo "  1. export ANTHROPIC_API_KEY=your_key"
      echo "  2. export GEMINI_API_KEY=your_key"
      echo "  3. Type: claude"
      echo ""

ports:
  - port: 3000
    onOpen: open-preview
    visibility: public
    name: Welcome Page

vscode:
  extensions: []
